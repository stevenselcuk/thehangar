# üõ©Ô∏è The Hangar

[![CI/CD Pipeline](https://github.com/stevenselcuk/thehangar/actions/workflows/ci.yml/badge.svg)](https://github.com/stevenselcuk/thehangar/actions/workflows/ci.yml)
[![Dependency Review](https://github.com/stevenselcuk/thehangar/actions/workflows/dependency-review.yml/badge.svg)](https://github.com/stevenselcuk/thehangar/actions/workflows/dependency-review.yml)
[![Health Check](https://github.com/stevenselcuk/thehangar/actions/workflows/health-check.yml/badge.svg)](https://github.com/stevenselcuk/thehangar/actions/workflows/health-check.yml)
[![CodeQL](https://github.com/stevenselcuk/thehangar/actions/workflows/codeql.yml/badge.svg)](https://github.com/stevenselcuk/thehangar/actions/workflows/codeql.yml)

> _"Installed 40 x MS20470AD rivets instead of icebox... The paperwork is filed. The night shift begins. And somewhere in the metal darkness, something... There is nothing but suffer in here"_

**Play Now**: [Production (Weekly Updates)](https://hangar.tabbythecat.com) | [Staging (Nightly Builds)](https://stevenselcuk.github.io/thehangar/)

![The Hangar Screenshot](https://i.imgur.com/kqBEnaP.png)

---

# Notes

> **‚ö†Ô∏è IMPORTANT**: THIS GAME IS NOT INTENDED FOR MINOR OR YOUNG ADULTS

> **‚ö†Ô∏è IMPORTANT**: THIS DOCUMENTATION IS INCLUDES SPOILERS... I MEAN FULL OF SPOILERS. DO NOT READ IF YOU HAVE NOT PLAYED THE GAME YET.

> **‚ö†Ô∏è IMPORTANT**: ALL NAMES, LOCATIONS AND OTHER DETAILS ARE FICTIONAL AND ARE NOT INTENDED TO BE TAKEN AS REAL.

> **‚ö†Ô∏è IMPORTANT**: ALL REFERENCES TO SPECIFIC PRODUCTS, BRANDS, OR SERVICES ARE FOR ILLUSTRATIVE PURPOSES ONLY AND DO NOT IMPLY ENDORSEMENT OR ENDORSEMENT.

> **‚ö†Ô∏è IMPORTANT**: FLASHES AND FLICKERS CAN CAUSE SEIZURES IN SOME PEOPLE. IF YOU ARE SUSCEPTIBLE TO SEIZURES, PLEASE PLAY AT YOUR OWN RISK.

> **‚ö†Ô∏è IMPORTANT**: ONCE AGAIN! THIS DOCUMENTATION IS INCLUDES SPOILERS. THIS IS THE LAST WARNING.

---

# What is The Hangar?

**The Hangar** is a browser-based incremental horror RPG where **corporate aviation meets cosmic dread**. You're an aircraft maintenance technician working the graveyard shift at a remote commercial facility. What begins as routine maintenance, installing rivets, filing paperwork, calibrating torque wrenches and gradually reveals something _profoundly wrong_ with your workplace.

### Why Play The Hangar?

#### üéÆ For Idle Game Fans

- **Deep Progression**: 50 levels, 100+ skills, multiple automation paths
- **Resource Juggling**: Balance Focus, Sanity, Suspicion, and Credits
- **Meaningful Choices**: Every action has trade-offs and consequences
- **No Ads, No IAP**: Completely free, no monetization, no data tracking

#### üìñ For Horror Enthusiasts

- **Lovecraftian Atmosphere**: Cosmic horror meets Office Space
- **Gradual Dread**: Subtle wrongness escalates into existential terror
- **Multiple Endings**: Uncover the truth, go mad, or become complicit
- **Environmental Storytelling**: Piece together the facility's dark history through maintenance logs, surveillance footage, and KARDEX archives

#### ‚úàÔ∏è For Aviation Professionals

- **Authentic Terminology**: Real maintenance procedures, part numbers, regulatory frameworks (FAA/EASA)
- **Rotable Management**: Component condition tracking, serviceable limits, airworthiness tags
- **Line Operations**: Transit checks, daily inspections, AOG deployments, Minimum Equipment List (MEL) logic
- **Bureaucratic Horror**: The paperwork _actually fights back_

#### üïπÔ∏è For Narrative Game Lovers

- **Branching Story**: Your choices shape the narrative across 6 progression phases
- **Character Depth**: Janitor, Regulars, Night Crew, The Suits‚Äîeach with hidden motives
- **Dynamic Events**: 100+ random encounters ranging from mundane audits to eldritch manifestations
- **Environmental Layers**: Explore 11 distinct locations, each with secrets and dangers

### Rest of other features

‚úÖ **No Install Required** - Runs in any modern browser (Chrome, Firefox, Safari, Edge)  
‚úÖ **100% Free & Open Source** - MIT license, no ads, no tracking  
‚úÖ **Auto-Save System** - Pick up exactly where you left off  
‚úÖ **Responsive Design** - Play on desktop, tablet, or mobile  
‚úÖ **Active Development** - Weekly updates, responsive to community feedback  
‚úÖ **Stability** - 90%+ test coverage, CI/CD pipeline, production monitoring

---

## üé≠ Game Narrative & Story

### Setting: [REDACTED] Aerospace Facility

**Location**: Remote commercial aviation maintenance base, exact coordinates classified  
**Time Period**: Contemporary, but the technology feels... off  
**Your Role**: Probationary Aircraft Maintenance Technician (AMT), Airframe & Powerplant license pending

### The Story in Six Acts

#### üåÖ **Phase 1: Orientation (Levels 0-5)**

_"Welcome to [REDACTED] Aerospace. Your supervisor is unavailable. Please begin with Tool Checkout."_

You're the new hire. Everything seems normal at first:

- Punch the time clock
- Check out tools from the Toolroom Master
- Perform basic inspections on parked aircraft
- File Service Request Forms (SRFs)
- Try not to think about why the previous technician left

**Narrative Themes**: Mundane work routines, bureaucratic onboarding, establishing normalcy

#### üåô **Phase 2: First Anomalies (Levels 6-15)**

_"Night shift eligible. The hangar is different after dark."_

Cracks appear in the facade:

- The night crew operates under different rules
- Rotable components arrive with no paperwork
- The vending machine dispenses items that shouldn't exist
- Surveillance cameras track you in impossible ways
- A sedan with tinted windows parks on the apron every night at 02:17

**Narrative Themes**: Escalating wrongness, workplace paranoia, the weight of compliance

#### üï≥Ô∏è **Phase 3: The Pattern Emerges (Levels 16-25)**

_"You have noticed the cameras. They have noticed you noticing."_

The facility's true nature reveals itself:

- The Suits appear‚Äîfigures in charcoal grey who should not be looked at directly
- Maintenance logs reference work on aircraft that don't exist
- The KARDEX filing system contains records from decades before the facility opened
- F.O.D. (the hangar cat) exhibits behaviors that violate known biology
- Certain components _resist_ removal

**Narrative Themes**: Conspiracy, eldritch manifestation, regulatory capture by unknowable entities

#### üìö **Phase 4: Deep Lore (Levels 26-35)**

_"The legacy archives boot. The screen turns green. You should not be reading this."_

Access to restricted systems:

- 1970s database containing "incident reports" about things that weren't accidents
- Physical KARDEX archives with cards stained with dried... something
- Black market channels for parts that can't be traced
- The Backshops, where components are overhauled and sometimes... altered
- Training modules that teach skills no FAA curriculum includes

**Narrative Themes**: Historical depth, institutional memory of horror, complicity of previous technicians

#### ‚öôÔ∏è **Phase 5: Preparation (Levels 36-48)**

_"They have stopped watching. You realize this is worse."_

The endgame approaches:

- AOG (Aircraft on Ground) deployments to remote stations
- Upload protocols to "clean" contaminated systems
- Gather rare resources: bio-filament, crystalline resonators, KARDEX fragments
- The metallic sphere (if found) begins to resonate
- Performance reviews with HR that alter your perception of time

**Narrative Themes**: Agency vs. determinism, gathering power, preparing for revelation

#### üåå **Phase 6: Truth Reveal (Level 49)**

_"The hangar door opens to the void."_

**Three Endings**:

1. **üõ∏ Alien Conspiracy** _(Requires: Metallic Sphere)_  
   The sphere opens. They were never from here. You understand now why the aircraft are built the way they are. The components aren't failing‚Äîthey're _evolving_. The maintenance isn't keeping them airworthy. It's keeping them _contained_.

2. **üèõÔ∏è Government Conspiracy** _(Default path)_  
   The man in the suit extends his hand. His skin is cold. He offers you a position‚Äînot as a technician, but as someone who _manages_ technicians. The cycle continues. You shake his hand.

3. **üåÄ Madness Ending** _(Sanity ‚â§ 0)_  
   You stop fighting the noise. The hum of the hydraulic systems isn't just white noise‚Äîit's a voice, and it's been calling your name since the first shift. The metal accepts you. You become part of the machine.

### Key Characters & Entities

#### üò∂ **The Regular**

A veteran technician who has worked here "longer than the facility has existed." Speaks in warnings and half-remembered incidents. Knows where the bodies are buried‚Äîliterally or metaphorically, you're not sure.

**Key Quotes**:

- _"Don't work alone in Backshops after midnight."_
- _"The sedan? You haven't figured that out yet?"_
- _"When the janitor stops cleaning, that's when you run."_

#### üßπ **The Janitor**

An entity that appears to be human. Always cleaning surfaces that aren't dirty. Never speaks. Never blinks. Has been here since before the facility opened. May be protecting you. May be _studying_ you.

#### üï¥Ô∏è **The Suits**

Figures in charcoal grey business attire. Unscheduled auditors who appear at impossible hours. Do not look directly at them. Do not attempt to photograph them. Comply with their requests. They represent something beyond the FAA.

#### üêà‚Äç‚¨õ **F.O.D. (Foreign Object Debris)**

The hangar cat. Nests in the Structure Shop. Accepts canned tuna. Purrs like a diesel engine. Occasionally phases through solid matter. Trust increases with feeding. May be the only genuinely benevolent entity in the facility.

#### üë• **The Night Crew**

Work the graveyard shift. Operate under different Standard Operating Procedures (SOPs) than day crew. Will delegate work to you for a price. Run a side business involving untraceable rotables. The union knows things they shouldn't.

---

## üé≤ Game Mechanics Deep-Dive

### Core Resource System

The game revolves around managing four primary resources:

#### üí≠ **Focus (0-100)**

**What it represents**: Your mental capacity for technical work, concentration, and problem-solving.

**Consumption**:

- Basic actions: 5-15 Focus
- Complex repairs: 25-50 Focus
- Training/certification: 40-60 Focus

**Regeneration**:

- Base rate: +2 Focus per tick (15 FPS = ~0.13 Focus/second)
- Boosted by: Coffee, rest actions, low stress environments
- Reduced by: Delegation (automation), high Suspicion, environmental hazards

**Critical Threshold**: Below 30 Focus, you're vulnerable to accidents and failed actions.

#### üß† **Sanity (0-100)**

**What it represents**: Your grip on consensus reality, mental stability, and resistance to cosmic dread.

**Drain Sources**:

- Witnessing anomalies: -5 to -25 Sanity
- Reading forbidden documents: -10 to -20 Sanity
- Interacting with The Suits: -25 to -50 Sanity
- Working in Backshops: -1 Sanity per tick (passive drain)
- Performance reviews: -20 Sanity

**Restoration**:

- Petting F.O.D.: +5 to +15 Sanity
- Eating normal food: +5 to +10 Sanity
- Breaks in Canteen: +10 Sanity
- Talking to The Regular (sometimes): +10 Sanity or -10 Sanity (random)

**Failure State**: Sanity reaching 0 triggers the **Madness Ending**.

#### üîç **Suspicion (0-100)**

**What it represents**: Regulatory scrutiny, audit risk, compliance violations, and attention from authorities.

**Increase Sources**:

- Using untraceable parts: +10 to +15 Suspicion
- Automation/delegation: +1 to +5 Suspicion per action
- Accessing restricted files: +5 to +20 Suspicion
- Failed audits: +15 to +30 Suspicion
- Working in Backshops: +1 Suspicion per tick (passive)

**Reduction**:

- Successful compliance actions: -5 to -10 Suspicion
- Bribing auditors: -20 Suspicion (risky)
- Performance reviews: -10 Suspicion (costs Sanity)
- Re-education programs: -50 Suspicion (costs XP and resets you)

**Failure State**: Suspicion reaching 100 triggers **Termination (Game Over)**.

#### üíµ **Credits (Currency)**

**What it represents**: Money for purchasing tools, training, food, and bribes.

**Income Sources**:

- Completed transit checks: 50-150 Credits
- Daily inspections: 100-300 Credits
- Job card completion: 75-500 Credits
- Delegation passive income: 25-100 Credits per tick
- Found money in Lost & Found: 5-20 Credits

**Expenses**:

- Tools: 15-400 Credits (laser pointer to IR lamp)
- Consumables: 5-75 Credits (tuna to earmuffs)
- Training: 50-150 Credits per module
- Bribes: 100-200 Credits
- Food/breaks: 5-15 Credits

### Progression & Leveling System

#### Experience & Levels

**XP Formula**: `500 * (currentLevel + 1)` XP required for next level

**Example**:

- Level 0 ‚Üí 1: 500 XP
- Level 1 ‚Üí 2: 1,000 XP
- Level 10 ‚Üí 11: 5,500 XP
- Level 48 ‚Üí 49: 24,500 XP

**XP Sources**:

- Completing actions: 50-1,000 XP (varies by complexity)
- Resolving events: 100-800 XP
- First-time discoveries: 200-500 XP
- Successful audits: 300 XP
- Training certifications: 500-1,000 XP

**Milestone Unlocks** (Key Examples):

- **Level 1**: Toolroom access, tool checkout
- **Level 2**: Apron Line access, Lost & Found
- **Level 3**: Office access, internal mail, SRF filing
- **Level 6**: Night shift eligibility, delegation unlocked
- **Level 10**: HR Floor access, Corrosion Corner scavenging
- **Level 15**: Backshops authorization, anomaly analysis
- **Level 20**: Surveillance log access
- **Level 28**: KARDEX system access
- **Level 35**: Black market discovery
- **Level 49**: Truth Reveal, endings available

### Action System

#### Action Types

**1. Basic Actions** (Cost: 5-25 Focus)

- Inspect Vending Machine
- Rummage Lost & Found
- Pet F.O.D.
- Check Delayed Gate
- Listen to Walls

**2. Maintenance Actions** (Cost: 15-50 Focus, require tools)

- Marshal Aircraft (requires: Level 2, high-vis vest)
- Install Rivets (requires: rivet gun, 25 Focus)
- Deep Clean Vents (requires: 15 Focus, drops bio-filament)
- NDT Inspection (requires: HFEC scanner, 30 Focus)

**3. Administrative Actions** (Cost: 10-40 Focus)

- Create SRF (Service Request Form)
- Check Internal Mail
- Print Forbidden Page (requires: PC assembled)
- File Compliance Report

**4. Interaction Actions** (Cost: 0-30 Focus/Sanity)

- Talk to Regular (random outcome: clue, warning, or rambling)
- Feed F.O.D. (requires: canned tuna, restores Sanity)
- Use Payphone (costs 5 Credits, reveals lore)
- Talk to Suits (extremely risky, -15 to -50 Sanity)

**5. Research Actions** (Cost: 25-60 Focus, high XP)

- Cross-Reference KARDEX (drops KARDEX fragments)
- Consult Legacy Archives (1970s database access)
- Review Surveillance Logs (reveals patterns)
- Decrypt AMM (requires: PC assembled)

**6. Risky Actions** (High cost, high reward/penalty)

- Scavenge Corrosion Corner (10 Focus, 40 Suspicion, drops untraceable rotables)
- Bribe Auditor (100 Credits, -20 Suspicion or +10 Suspicion if caught)
- Force System Override (50 Focus, 20 Sanity, massive Suspicion if failed)
- Sacrifice Tool (requires: wrench, random Sanity outcome)

### Job System

#### Aircraft Types

- **Narrow-body**: A320, B737 (common, lower rewards)
- **Wide-body**: A330, B777 (rare, higher rewards)
- **Regional**: CRJ, ERJ (quick turnaround)
- **Freighters**: B747-F, B767-F (complex, night operations)

#### Maintenance Checks

**Transit Check** (15 min, 50-100 Credits, 200 XP)

- Visual inspection
- Fluid level verification
- Minor discrepancies only
- Low stress, routine

**Daily Inspection** (30 min, 100-200 Credits, 400 XP)

- Detailed walkaround
- Logbook review
- Minor repairs authorized
- May discover anomalies

**ETOPS Check** (60 min, 300-500 Credits, 800 XP)

- Extended Operations certification
- Critical systems verification
- Engine run required
- High Suspicion if failed

**AOG (Aircraft on Ground)** (90 min, 500-800 Credits, 1200 XP)

- Emergency deployment
- Remote station work
- High stress, time pressure
- Elevated anomaly risk

### Event System

#### Event Categories (10 types)

**1. Story Events** (Level 0+)

- Narrative flavor, world-building
- Low mechanical impact
- Example: "Safety Wire Ghost" - phantom technician re-doing your work

**2. Incident Events** (Level 2+)

- Minor mishaps, rush jobs
- Medium mechanical impact
- Example: "FOD on Ramp" - foreign object cleanup required

**3. Accident Events** (Level 3+)

- Electrical fires, hydraulic failures
- High mechanical impact
- Example: "Skydrol Leak" - hazmat response, Sanity drain

**4. Audit Events** (Level 5+)

- FAA spot-checks, EASA inspections
- Suspicion increases on failure
- Example: "Tool Calibration Audit" - must prove torquemeter accuracy

**5. Canteen Incident** (Level 5+)

- Strange encounters in break room
- Sanity effects, lore reveals
- Example: "Vending Machine Prophecy" - the machine displays tomorrow's maintenance log

**6. Component Failure** (Level 8+)

- Rotables degrading catastrophically
- Expensive repairs or replacements
- Example: "IDG Failure" - generator hums tunes for dead dogs

**7. Bureaucratic Horror** (Level 10+)

- Paperwork anomalies, infinite forms
- Focus drain, Suspicion risk
- Example: "Logbook Recursion" - entry references itself in past tense from the future

**8. Eldritch Manifestation** (Level 15+)

- Cosmic horror, reality breakdown
- Massive Sanity drain, existential revelations
- Example: "The Hum" - structural resonance in Backshops, geometry is wrong

**9. Union Events** (Level 18+)

- Night crew interactions, labor disputes
- Access to restricted knowledge
- Example: "Shop Steward's Warning" - they know about SLS-3, the door that shouldn't exist

**10. Syndicate Events** (Level 20+)

- Black market offers, illegal parts
- High risk, high reward
- Example: "Untraceable Offer" - rotables with no serial numbers, no questions asked

### Toolroom System

#### Tool Categories

**Precision Tools** (require calibration)

- Torquemeter (measures bolt tension)
- Micrometer (measures tolerance)
- Calibration status: 0-100%, degrades with use
- Calibration mini-game: adjust needle to target range

**Power Tools** (degrade with use)

- Rivet Gun (structural repairs, 8x efficiency boost)
- Atlas Copco Drill (high-torque operations)
- Orbital Sander (surface prep)
- Condition: 0-100%, repairs cost Credits

**Specialty Equipment** (checked out, time-limited)

- HFEC Scanner (crack detection, eddy current)
- Rototest Unit (electrical phase testing)
- Air Data Test Box (pitot-static simulation)
- Checkout window: 2 hours, penalties for late return

**Hand Tools** (permanent, basic)

- Wrenches, screwdrivers, hammers
- No degradation
- Required for basic actions

### Automation & Delegation

**Night Crew Delegation** (Level 6+)

- Passive Credit generation: 25-100 per tick
- Passive XP generation: 10-50 per tick
- **Cost**: Suspicion increases by 1-3 per tick
- **Trade-off**: Less Focus regeneration (night crew uses resources)

**Automated Systems** (Level 12+)

- SRF Auto-Filing: Generates paperwork passively
- Transit Check Delegation: Outsource routine inspections
- Tool Calibration Service: Pay to skip mini-game
- **Risk**: Low chance of triggering audits

### Pet System: F.O.D.

**Stats**:

- **Trust**: 0-100 (increases with interaction)
- **Hunger**: 0-100 (increases over time, must feed)

**Interactions**:

- **Feed** (requires: canned tuna, 5 Credits)
  - Hunger: -30
  - Trust: +5
  - Sanity: +15
  - Log: _"He emerges from the shadows, eats ravenously, and purrs like a diesel engine."_

- **Play** (requires: laser pointer, 10 Focus)
  - Trust: +5
  - Sanity: +10
  - Log: _"The red dot dances. F.O.D. hunts it with lethal precision."_

- **Pet** (requires: 2 Focus)
  - 80% chance: Trust +2, Sanity +5, _"He leans into your hand and purrs."_
  - 20% chance: Trust +1, _"He bites you softly. Love bite?"_

**High Trust Benefits** (Trust > 75):

- F.O.D. warns of approaching Suits (-25% Sanity drain)
- Reveals hidden items in Structure Shop
- Sits on your lap during breaks (+5 passive Sanity regen)

---

## üïπÔ∏è Gameplay Guide

### For New Players: First Hour

**Minutes 1-5: Orientation**

1. Start game, read intro
2. Navigate to **Canteen** tab
3. Use action: **Inspect Vending Machine** (10 Focus)
4. Navigate to **Hangar** tab
5. Familiarize yourself with resource bars (Focus, Sanity, Suspicion, Credits)

**Minutes 5-15: Tool Acquisition**

1. Reach **Level 1** (500 XP, should happen naturally)
2. Navigate to **Toolroom** tab (unlocked at Level 1)
3. Check out basic tools: **wrench**, **screwdriver**, **flashlight**
4. Return to **Hangar**, attempt a **Transit Check** on parked aircraft

**Minutes 15-30: Office Access**

1. Reach **Level 3** (2,500 total XP)
2. Navigate to **Office** tab (unlocked at Level 3)
3. Use action: **Talk to Regular** (10 Focus)
4. Use action: **Check Internal Mail** (5 Focus)
5. Use action: **Create SRF** (20 Focus) - your first paperwork!

**Minutes 30-60: Building Momentum**

1. Save Credits, purchase **rivet gun** from Shop (150 Credits)
2. Navigate to **Structure Shop** (unlocked at Level 5)
3. Find **F.O.D.** (the cat), begin feeding (requires canned tuna)
4. Complete **Daily Inspections** for higher rewards
5. Watch for your first **Event** (likely an Audit or Incident)

### Optimal Early Game Strategy

**Priority 1: Get the Rivet Gun** (Level ~4-5)

- The rivet gun **multiplies efficiency by 8x**
- Costs 150 Credits (save from Transit Checks)
- Unlocks structural maintenance actions
- Required for Level 4 milestone: "Install Rivets"

**Priority 2: Manage Suspicion** (Keep < 30 early game)

- Avoid automation until Level 10+
- Don't scavenge Corrosion Corner yet (massive Suspicion spike)
- Pass all Audits (compliance is survival)

**Priority 3: Maintain Sanity** (Keep > 50)

- Feed F.O.D. regularly (Trust > 50 by Level 10)
- Avoid talking to Suits (not worth the Sanity loss early)
- Take breaks in Canteen when Sanity < 60

**Priority 4: Skill Investment**

- **Mechanical Intuition** (reduces Focus costs for maintenance)
- **Paperwork Efficiency** (reduces time for admin actions)
- **Stress Management** (reduces Sanity drain)

### Mid-Game Strategy (Levels 10-25)

**Goals**:

- Unlock all 11 location tabs
- Begin automation (Night Crew delegation)
- Acquire specialty tools (HFEC scanner, torquemeter)
- Survive first Eldritch Manifestation

**Key Milestones**:

- **Level 10**: HR Floor access - Scavenge Corrosion Corner (untraceable rotables)
- **Level 15**: Backshops authorization - Analyze Anomaly
- **Level 20**: Surveillance Logs access - Review Logs (pattern recognition)

**Resource Balance Shift**:

- Suspicion tolerance increases (you can risk 40-60 Suspicion)
- Sanity becomes critical (eldritch events hit harder)
- Credits are plentiful (focus on rare resource gathering)

**Rare Resources to Collect**:

- **Bio-Filament**: From Deep Clean Vents (common)
- **Crystalline Resonators**: From Scavenge Corrosion Corner (uncommon)
- **KARDEX Fragments**: From Cross-Reference KARDEX (rare)

### Late Game Strategy (Levels 26-49)

**Goals**:

- Collect all 3 rare resources (10+ of each)
- Find the **Metallic Sphere** (hidden in SLS-3 door discovery)
- Decide which ending to pursue
- Max out critical skills

**Ending Preparation**:

**For Alien Ending**:

- Acquire Metallic Sphere (Level 35+, Black Market access)
- Access SLS-3 door (hidden in Backshops)
- Complete "Check Black Market" action
- Trigger: Use Metallic Sphere at Level 49

**For Government Ending**:

- Maintain Suspicion between 40-70 (visible to authorities, not hostile)
- Build relationship with The Suits (risky, high Sanity cost)
- Accept all Performance Reviews
- Trigger: Default ending at Level 49

**For Madness Ending**:

- Allow Sanity to drop below 20
- Engage in high-risk actions (Observe Sedan, Listen to Fuselage repeatedly)
- Consume "Void Burger" from Canteen
- Trigger: Automatic when Sanity reaches 0

### Expert Tips & Hidden Mechanics

**1. The Sedan Timing**

- Appears on Apron at exactly 02:17 (in-game time)
- Observing it 5+ times unlocks "Sedan Recognition" perk
- License plate changes geometry if Sanity < 30

**2. Janitor Patterns**

- Appears every 10 minutes (real-time)
- Always cleaning a surface that isn't dirty
- If he _stops_ cleaning and leaves, an Eldritch Manifestation is imminent

**3. Regular's Clues**

- Talking to Regular has 3 outcomes (30% clue, 60% warning, 10% rambling)
- Clues reference future events (3-5 levels ahead)
- Warnings can prevent catastrophic failures if heeded

**4. F.O.D.'s Hunger**

- If Hunger > 80 for extended period, F.O.D. becomes hostile
- Hostile F.O.D. triggers "Cat Scratch" event (infection, -20 Sanity)
- Keep canned tuna in inventory (5 Credits at Shop)

**5. Tool Calibration RNG**

- Calibration mini-game has hidden tolerance band
- Success rate improves with **Precision Training** skill
- Failed calibrations can cause critical failures during use

**6. Mail System Secrets**

- Internal mail contains hints about upcoming audits
- Memos from "Management" reference things that haven't happened yet
- Encrypted messages appear at Level 20+ (requires Decrypt AMM action)

**7. Surveillance Log Patterns**

- Reviewing logs reveals cycles: 7-day pattern in anomaly frequency
- Certain anomalies only occur on specific days
- Friday night shifts have 2x eldritch manifestation rate

**8. KARDEX Fragment Uses**

- Collect 10+ fragments to unlock "Historical Context" perk
- Fragments can be sacrificed for massive XP boost (500 XP per fragment)
- Required for certain late-game lore reveals

---

## üõ†Ô∏è Technical Documentation

### Technology Stack

#### Frontend Framework

- **React 19.0** - Latest stable, new JSX transform, automatic batching
- **TypeScript 5.8** - Strict mode, exhaustive type checking
- **Vite 6.2** - Sub-second HMR, ESBuild compilation

#### State Management Architecture

- **Pattern**: Custom reducer with Immer immutability
- **No Dependencies**: Zero external state libraries (Redux, Zustand, MobX)
- **Structure**:
  ```
  gameReducer.ts (459 lines)
  ‚îú‚îÄ‚îÄ reducerComposer.ts (621 lines) - Action routing
  ‚îî‚îÄ‚îÄ slices/ (12 domain reducers, ~2,700 lines total)
      ‚îú‚îÄ‚îÄ aircraftSlice.ts
      ‚îú‚îÄ‚îÄ backshopSlice.ts
      ‚îú‚îÄ‚îÄ complianceSlice.ts
      ‚îú‚îÄ‚îÄ encountersSlice.ts
      ‚îú‚îÄ‚îÄ eventsSlice.ts
      ‚îú‚îÄ‚îÄ hangarSlice.ts
      ‚îú‚îÄ‚îÄ inventorySlice.ts
      ‚îú‚îÄ‚îÄ officeSlice.ts
      ‚îú‚îÄ‚îÄ proficiencySlice.ts
      ‚îú‚îÄ‚îÄ resourcesSlice.ts
      ‚îú‚îÄ‚îÄ shopSlice.ts
      ‚îî‚îÄ‚îÄ terminalSlice.ts
  ```

#### Game Loop Implementation

- **requestAnimationFrame** (RAF) based
- **Target**: 15 FPS (configurable via `TARGET_FPS`)
- **Delta Time**: Tracks frame timing for consistent behavior
- **Throttling**: Ensures consistent tick rate regardless of device performance

#### Styling & UI

- **TailwindCSS 4.0** - Utility-first, JIT compilation
- **Theme**: Terminal green aesthetic (`#0f0`, `#000`, monospace fonts)
- **Responsive**: Mobile-first design, breakpoints at 640px, 768px, 1024px
- **Accessibility**: WCAG 2.1 AA compliant (high contrast, keyboard navigation)

#### Testing Framework

- **Unit/Integration**: Vitest 2.0 + React Testing Library
- **E2E**: Playwright 1.48 (Chromium, Firefox, WebKit)
- **Coverage**: Codecov integration, 90%+ target
- **CI/CD**: GitHub Actions (runs on every push)

### Architecture Patterns

#### State Management Flow

```
User Interaction (click button)
  ‚Üì
Component dispatches action: dispatch({ type: 'PERFORM_ACTION', payload: 'INSTALL_RIVETS' })
  ‚Üì
gameReducer.ts receives action
  ‚Üì
reducerComposer.ts routes to appropriate slice
  ‚Üì
Slice (e.g., hangarSlice.ts) processes with Immer
  ‚Üì
New state returned (immutable)
  ‚Üì
React re-renders affected components
```

#### Tick System Flow

```
requestAnimationFrame callback (60 FPS browser)
  ‚Üì
Throttle to 15 FPS (TARGET_FPS)
  ‚Üì
Dispatch: { type: 'TICK', payload: deltaTime }
  ‚Üì
reducerComposer.composeTick() aggregates all slices
  ‚Üì
Each slice processes passive effects:
  - resourcesSlice: regenerate Focus/Sanity
  - eventsSlice: countdown event timers
  - inventorySlice: degrade tool condition
  - encountersSlice: roll for janitor spawn
  ‚Üì
State updates batched and returned
  ‚Üì
React re-renders with new state
```

#### Event System Architecture

```typescript
// Event Definition (data/events.ts)
interface GameEvent {
  id: string;
  category: EventCategory;
  title: string;
  description: string;
  choices: EventChoice[];
  levelRequirement: number;
  timeLeft?: number; // Added at spawn time
}

// Event Spawning (eventsSlice.ts)
function spawnEvent(state: GameState): GameState {
  const eligibleEvents = events.filter(
    (e) =>
      e.levelRequirement <= state.resources.level &&
      !state.events.activeEvents.some((ae) => ae.id === e.id)
  );

  const template = eligibleEvents[Math.floor(Math.random() * eligibleEvents.length)];
  const event = { ...template, timeLeft: 60000 }; // 60 seconds

  return produce(state, (draft) => {
    draft.events.activeEvents.push(event);
    addLogToDraft(draft, `EVENT: ${event.title}`, 'warning');
  });
}
```

### Performance Optimizations

#### Bundle Size

- **Production Build**: ~480KB (before gzip)
- **Gzipped**: ~145KB
- **Brotli**: ~130KB

**Optimizations Applied**:

- Tree-shaking via Vite/Rollup
- Code splitting (routes, tabs)
- Dynamic imports for heavy components
- No moment.js (using native Date)
- No lodash (using native ES6+)

#### Runtime Performance

- **Initial Load**: < 2 seconds (4G connection)
- **Time to Interactive**: < 3 seconds
- **Frame Budget**: 66ms per frame (15 FPS)
- **Actual Frame Time**: 8-15ms average (well within budget)

**Optimization Techniques**:

- `React.memo()` for expensive components
- `useMemo()` for derived state calculations
- `useCallback()` for event handlers
- Debounced auto-save (2-second delay)

#### Memory Management

- **Heap Size**: ~50MB average (stable)
- **localStorage**: ~1-2MB per save (JSON serialized)
- **No Memory Leaks**: Verified via Chrome DevTools heap snapshots

**Techniques**:

- Proper cleanup in `useEffect` hooks
- Event listener removal on unmount
- Audio objects released after playback

### Data Persistence

#### Save System

- **Storage**: Browser localStorage
- **Key**: `thehangar_save_v1`
- **Format**: JSON serialized GameState
- **Frequency**: Auto-save every 2 seconds (debounced)
- **Manual Save**: Available via Settings menu

**Save Data Structure**:

```json
{
  "version": 1,
  "timestamp": 1738872000000,
  "state": {
    "resources": { "focus": 85, "sanity": 62, ... },
    "inventory": { "rivetGun": 1, "wrench": 1, ... },
    "flags": { "officeUnlocked": true, ... },
    "rotables": [...],
    "events": {...},
    ... 12 additional state slices
  }
}
```

#### Migration Strategy

- **Version Check**: On load, compare saved version to current
- **Auto-Migration**: Apply transformations for older save formats
- **Fallback**: If migration fails, offer "New Game" with warning

---

## üöÄ Development Setup

### Prerequisites

- **Node.js**: 18.x or higher (LTS recommended)
- **Package Manager**: npm 9+, pnpm 8+, or yarn 4+
- **Git**: Latest stable
- **Browser**: Chrome 120+, Firefox 121+, Safari 17+, or Edge 120+

### Quick Start

```bash
# Clone repository
git clone https://github.com/stevenselcuk/thehangar.git
cd thehangar

# Install dependencies
npm install

# Start development server (http://localhost:5173)
npm run dev

# In browser console, enable dev mode:
window.enableDevMode()
```

### Development Commands

```bash
# Development
npm run dev              # Vite dev server with HMR
npm run build            # Production build ‚Üí dist/
npm run preview          # Preview production build locally

# Code Quality
npm run lint             # ESLint check (all files)
npm run lint:fix         # Auto-fix linting issues
npm run format           # Prettier format (write)
npm run format:check     # Prettier check (no write)

# Testing
npm test                 # Vitest watch mode
npm run test:run         # Run tests once (CI mode)
npm run test:coverage    # Generate coverage report
npm run test:ui          # Interactive test UI (browser)
npm run test:e2e         # Playwright E2E tests
npm run test:e2e:ui      # Playwright with UI mode
npm run test:e2e:debug   # Debug E2E tests (headed)

# Type Checking
npm run typecheck        # TypeScript compilation check
```

### Project Structure

```
thehangar/
‚îú‚îÄ‚îÄ .github/                  # GitHub-specific files
‚îÇ   ‚îú‚îÄ‚îÄ workflows/            # CI/CD workflows (4 files)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ci.yml            # Main CI/CD pipeline
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ codeql.yml        # Security scanning
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ dependency-review.yml
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ health-check.yml  # Weekly monitoring
‚îÇ   ‚îú‚îÄ‚îÄ copilot-instructions.md  # AI assistant guidelines (3,800 lines)
‚îÇ   ‚îî‚îÄ‚îÄ WORKFLOWS.md          # Workflow documentation
‚îú‚îÄ‚îÄ __tests__/                # Test suites
‚îÇ   ‚îú‚îÄ‚îÄ fixtures/             # Test fixtures (game states)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ gameStates.ts     # 784 lines of test data
‚îÇ   ‚îú‚îÄ‚îÄ components/           # Component tests (RTL)
‚îÇ   ‚îú‚îÄ‚îÄ logic/                # Pure function tests
‚îÇ   ‚îú‚îÄ‚îÄ services/             # Service layer tests (100% coverage)
‚îÇ   ‚îú‚îÄ‚îÄ slices/               # Reducer slice tests
‚îÇ   ‚îî‚îÄ‚îÄ state/                # State management tests
‚îú‚îÄ‚îÄ e2e/                      # Playwright E2E tests
‚îÇ   ‚îî‚îÄ‚îÄ game-flow.spec.ts     # Full gameplay E2E
‚îú‚îÄ‚îÄ public/                   # Static assets
‚îÇ   ‚îú‚îÄ‚îÄ sounds/               # Audio files (.mp3)
‚îÇ   ‚îî‚îÄ‚îÄ favicon.ico
‚îú‚îÄ‚îÄ src/                      # Source code
‚îÇ   ‚îú‚îÄ‚îÄ components/           # React components
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ tabs/             # Tab components (11 files)
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ActionPanel.tsx   # Main game router
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ BackshopsTab.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CanteenTab.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HangarTab.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ HRFloorTab.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ OfficeTab.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RampTab.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ShopTab.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ StructureShopTab.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ TerminalTab.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ToolroomTab.tsx
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ modals/           # Modal components
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ AboutModal.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ EventModal.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ SettingsModal.tsx
‚îÇ   ‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ StatsModal.tsx
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ ui/               # Reusable UI components
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ Button.tsx
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ ProgressBar.tsx
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ Tooltip.tsx
‚îÇ   ‚îú‚îÄ‚îÄ data/                 # Static game data (never mutate!)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ actions.ts        # Action definitions (1,200+ lines)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ aircraftTypes.ts  # Aircraft specifications
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ events.ts         # Event templates (800+ lines)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ featureRegistry.ts # Level-gated features
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ flavor.ts         # Atmospheric text (500+ lines)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ items.ts          # Tools, consumables, rotables
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ levelMilestones.ts # 50 level definitions
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ mail.ts           # Internal mail templates
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ skills.ts         # Skill tree (100+ skills)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ training.ts       # Certification modules
‚îÇ   ‚îú‚îÄ‚îÄ hooks/                # Custom React hooks
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useAutoSave.ts    # Debounced persistence
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ useGameEngine.ts  # RAF game loop
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ useSound.ts       # Audio playback
‚îÇ   ‚îú‚îÄ‚îÄ logic/                # Pure game logic
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ actionProcessor.ts # Action resolution (complex)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ eventSpawner.ts   # Random event generation
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ levels.ts         # XP/leveling calculations
‚îÇ   ‚îú‚îÄ‚îÄ services/             # Business logic services
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ CostCalculator.ts     # Cost validation (100% tested)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ RewardCalculator.ts   # Reward computation (100% tested)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ ResourceValidator.ts  # Resource checks (100% tested)
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ logService.ts         # Log management (100% tested)
‚îÇ   ‚îú‚îÄ‚îÄ state/                # State management
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gameReducer.ts        # Main reducer (459 lines)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ reducerComposer.ts    # Routing layer (621 lines)
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ initialState.ts       # Default state + loader
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ stateValidator.ts     # Runtime type checking
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ slices/               # Domain reducers (~2,700 lines)
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ aircraftSlice.ts      # Aircraft operations
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ backshopSlice.ts      # Component overhaul
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ complianceSlice.ts    # Audits, HR, docs
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ encountersSlice.ts    # NPCs, entities
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ eventsSlice.ts        # Event lifecycle
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ hangarSlice.ts        # Hangar operations
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ inventorySlice.ts     # Tools, calibration
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ officeSlice.ts        # PC, mail, filing
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ proficiencySlice.ts   # Skills, training
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ resourcesSlice.ts     # Resource regen
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ shopSlice.ts          # Purchasing
‚îÇ   ‚îÇ       ‚îú‚îÄ‚îÄ terminalSlice.ts      # Archive terminal
‚îÇ   ‚îÇ       ‚îî‚îÄ‚îÄ terminalLocationSlice.ts # Terminal nav
‚îÇ   ‚îú‚îÄ‚îÄ utils/                # Utilities
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ gameHelpers.ts    # Log mgmt, clamping, checks
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ testHelpers.ts    # Seeded random, fixtures
‚îÇ   ‚îú‚îÄ‚îÄ types.ts              # TypeScript types (379 lines)
‚îÇ   ‚îú‚îÄ‚îÄ App.tsx               # Root component
‚îÇ   ‚îú‚îÄ‚îÄ main.tsx              # Entry point
‚îÇ   ‚îî‚îÄ‚îÄ styles.css            # Global styles
‚îú‚îÄ‚îÄ docs/                     # Documentation
‚îÇ   ‚îú‚îÄ‚îÄ game_mechanics.md     # Full mechanics breakdown
‚îÇ   ‚îî‚îÄ‚îÄ CONTRIBUTING.md       # Contribution guidelines
‚îú‚îÄ‚îÄ .eslintrc.json            # ESLint config (strict)
‚îú‚îÄ‚îÄ .prettierrc               # Prettier config
‚îú‚îÄ‚îÄ tsconfig.json             # TypeScript config (strict mode)
‚îú‚îÄ‚îÄ vite.config.ts            # Vite configuration
‚îú‚îÄ‚îÄ vitest.config.ts          # Vitest configuration
‚îú‚îÄ‚îÄ playwright.config.ts      # Playwright configuration
‚îú‚îÄ‚îÄ package.json              # Dependencies & scripts
‚îî‚îÄ‚îÄ README.md                 # This file
```

### Code Style Guidelines

#### Import Conventions

```typescript
// ‚úÖ CORRECT: Always include file extensions
import { actionsData } from './data/actions.ts';
import { GameState } from './types.ts';
import Button from './components/ui/Button.tsx';

// ‚ùå INCORRECT: Missing extensions
import { actionsData } from './data/actions';
import { GameState } from './types';
```

#### State Updates (Immer)

```typescript
// ‚úÖ CORRECT: Use Immer's produce()
import { produce } from 'immer';

function myReducer(state: GameState, action: Action): GameState {
  return produce(state, (draft) => {
    draft.resources.focus -= 10;
    draft.logs.push({ message: 'Action performed', timestamp: Date.now() });
  });
}

// ‚ùå INCORRECT: Direct mutation
function myReducer(state: GameState, action: Action): GameState {
  state.resources.focus -= 10; // BREAKS IMMUTABILITY
  return state;
}
```

#### Logging Pattern

```typescript
// ‚úÖ CORRECT: Use logService helper
import { addLogToDraft } from '../services/logService.ts';

return produce(state, (draft) => {
  addLogToDraft(draft, 'You install the rivets. The metal holds. For now.', 'info');
});

// ‚ùå INCORRECT: Manual log creation
draft.logs.push({ message: 'Log message', timestamp: Date.now() }); // Missing type, formatting
```

#### Audio Playback

```typescript
// ‚úÖ CORRECT: Inline audio creation
new Audio('/sounds/ui_click.mp3').play().catch(() => {
  /* ignore */
});

// ‚ùå INCORRECT: Global audio objects
const clickSound = new Audio('/sounds/ui_click.mp3'); // Memory leak risk
```

#### Testing: Seeded Random

```typescript
// ‚úÖ CORRECT: Seed Math.random() in tests
import seedrandom from 'seedrandom';

beforeEach(() => {
  Math.random = seedrandom('test-seed-12345');
});

// ‚ùå INCORRECT: Unseeded tests
test('random event spawns', () => {
  const event = spawnRandomEvent(); // Non-deterministic!
});
```

### Adding New Features

For comprehensive workflows, see `.github/copilot-instructions.md`. Quick reference:

#### Adding a New Action

**1. Define in appropriate slice** (`src/state/slices/`)

```typescript
// src/state/slices/hangarSlice.ts
case 'INSPECT_WING':
  return produce(state, draft => {
    draft.resources.focus -= 15;
    draft.resources.experience += 200;
    addLogToDraft(draft, 'You inspect the wing. Rivets are... vibrating?', 'story');
  });
```

**2. Register in reducerComposer** (`src/state/reducerComposer.ts`)

```typescript
// Add to composeAction() routing
if (actionId === 'INSPECT_WING') {
  return hangarReducer(state, action);
}
```

**3. Add to actions data** (`src/data/actions.ts`)

```typescript
INSPECT_WING: {
  id: 'INSPECT_WING',
  label: 'Inspect Wing',
  baseCost: { focus: 15 },
  requiredItems: ['flashlight'],
  effects: [
    {
      chance: 1.0,
      log: 'You inspect the wing. Rivets are... vibrating?',
      logType: 'story',
      resourceModifiers: { experience: 200 },
    },
  ],
},
```

**4. Add UI button** (in relevant tab component)

```typescript
<Button
  onClick={() => dispatch({ type: 'PERFORM_ACTION', payload: 'INSPECT_WING' })}
  disabled={state.resources.focus < 15 || !state.inventory.flashlight}
>
  Inspect Wing (-15 Focus)
</Button>
```

**5. Write tests** (`__tests__/slices/hangarSlice.test.ts`)

```typescript
test('INSPECT_WING reduces focus and grants XP', () => {
  const state = createTestState({ resources: { focus: 50 } });
  const result = hangarReducer(state, { type: 'INSPECT_WING' });

  expect(result.resources.focus).toBe(35);
  expect(result.resources.experience).toBeGreaterThan(state.resources.experience);
  expect(result).not.toBe(state); // Immutability check
});
```

#### Adding a New Event

See full workflow in `.github/copilot-instructions.md`, section "Adding New Events".

#### Adding a New Tab/Location

See full workflow in `.github/copilot-instructions.md`, section "Adding New Components".

---

## üß™ Testing & Quality Assurance

### Test Coverage Goals

**Current Status**:

- **Overall**: ~75% coverage
- **Logic Layer**: ~95% (pure functions, calculators)
- **Services**: 100% (CostCalculator, RewardCalculator, logService)
- **State Slices**: ~70% (reducer logic)
- **Components**: ~5% ‚ö†Ô∏è **Critical Gap**

**Target**: 90%+ across all categories by v1.0

### Running Tests

```bash
# Unit & Integration (Vitest)
npm test                 # Watch mode (recommended for TDD)
npm run test:run         # Run once (CI mode)
npm run test:coverage    # Generate HTML coverage report ‚Üí coverage/index.html
npm run test:ui          # Interactive UI (browser-based)

# E2E (Playwright)
npm run test:e2e         # Headless (all browsers)
npm run test:e2e:ui      # Interactive UI mode
npm run test:e2e:debug   # Headed with debugger
```

### Test Structure

```
__tests__/
‚îú‚îÄ‚îÄ fixtures/
‚îÇ   ‚îî‚îÄ‚îÄ gameStates.ts         # Reusable test states (784 lines)
‚îú‚îÄ‚îÄ logic/
‚îÇ   ‚îî‚îÄ‚îÄ levels.test.ts        # XP calculations (95% coverage)
‚îú‚îÄ‚îÄ services/
‚îÇ   ‚îú‚îÄ‚îÄ CostCalculator.test.ts       # 100% coverage ‚úÖ
‚îÇ   ‚îú‚îÄ‚îÄ RewardCalculator.test.ts     # 100% coverage ‚úÖ
‚îÇ   ‚îî‚îÄ‚îÄ logService.test.ts           # 100% coverage ‚úÖ
‚îú‚îÄ‚îÄ slices/
‚îÇ   ‚îú‚îÄ‚îÄ hangarSlice.test.ts          # ~80% coverage
‚îÇ   ‚îú‚îÄ‚îÄ inventorySlice.test.ts       # ~75% coverage
‚îÇ   ‚îî‚îÄ‚îÄ proficiencySlice.test.ts     # ~70% coverage
‚îú‚îÄ‚îÄ state/
‚îÇ   ‚îú‚îÄ‚îÄ gameReducer.test.ts          # ~85% coverage
‚îÇ   ‚îî‚îÄ‚îÄ reducerComposer.test.ts      # ~75% coverage
‚îî‚îÄ‚îÄ components/
    ‚îú‚îÄ‚îÄ ErrorBoundary.test.tsx       # 100% coverage ‚úÖ
    ‚îî‚îÄ‚îÄ ... (‚ö†Ô∏è many untested)
```

### Testing Best Practices

#### 1. Determinism via Seeded Random

```typescript
import seedrandom from 'seedrandom';

beforeEach(() => {
  Math.random = seedrandom('consistent-seed');
});

afterEach(() => {
  Math.random = Math.random; // Restore original
});
```

#### 2. Immutability Verification

```typescript
test('state updates are immutable', () => {
  const original = createTestState();
  const updated = myReducer(original, someAction);

  expect(updated).not.toBe(original); // Reference inequality
  expect(original.resources.focus).toBe(100); // Original unchanged
});
```

#### 3. Use Test Fixtures

```typescript
import { createTestState, createHighLevelState } from '../fixtures/gameStates.ts';

test('high-level action unlocked', () => {
  const state = createHighLevelState({ level: 25 });
  // Test with realistic high-level state
});
```

#### 4. Coverage Enforcement

```bash
# package.json
"test:coverage": "vitest run --coverage --coverage.thresholds.lines=90"
```

---

## üîÑ CI/CD Pipeline

### GitHub Actions Workflows

#### 1. **Main CI/CD** (`.github/workflows/ci.yml`)

**Triggers**: Push to any branch, Pull Requests  
**Duration**: 3-5 minutes  
**Jobs**:

- ‚úÖ Lint check (ESLint)
- ‚úÖ Type check (TypeScript compilation)
- ‚úÖ Unit tests (Vitest)
- ‚úÖ E2E tests (Playwright, 3 browsers)
- ‚úÖ Build production bundle
- ‚úÖ Upload coverage to Codecov
- ‚úÖ Deploy to GitHub Pages (main branch only)

**Deployment**:

- **Staging**: `https://stevenselcuk.github.io/thehangar/` (auto-deploy from `main`)
- **Production**: `https://hangar.tabbythecat.com` (manual deploy, weekly)

#### 2. **CodeQL Security** (`.github/workflows/codeql.yml`)

**Triggers**: Weekly schedule, manual  
**Purpose**: Static analysis for security vulnerabilities  
**Scans**: JavaScript/TypeScript, dependencies

#### 3. **Dependency Review** (`.github/workflows/dependency-review.yml`)

**Triggers**: Pull Requests  
**Purpose**: Detect vulnerable dependencies before merge  
**Blocks**: PRs introducing high/critical CVEs

#### 4. **Health Check** (`.github/workflows/health-check.yml`)

**Triggers**: Weekly schedule  
**Purpose**: Monitor production site availability  
**Alerts**: Notifies on downtime or errors

### Badge Status

All badges at top of README:

- ![CI/CD](https://github.com/stevenselcuk/thehangar/actions/workflows/ci.yml/badge.svg) - Build status
- ![CodeQL](https://github.com/stevenselcuk/thehangar/actions/workflows/codeql.yml/badge.svg) - Security status
- ![Dependency Review](https://github.com/stevenselcuk/thehangar/actions/workflows/dependency-review.yml/badge.svg)
- ![Health Check](https://github.com/stevenselcuk/thehangar/actions/workflows/health-check.yml/badge.svg)

### Deployment Process

**Automatic (Staging)**:

```
git push origin main
  ‚Üì
GitHub Actions runs CI/CD
  ‚Üì
Tests pass ‚Üí Build succeeds
  ‚Üì
Deploy to GitHub Pages
  ‚Üì
Live at stevenselcuk.github.io/thehangar/
```

**Manual (Production)**:

```bash
# Weekly deployment to hangar.tabbythecat.com
1. Verify staging is stable
2. Run full test suite locally
3. Build production bundle
4. Upload to production host
5. Verify deployment health
```

---

## ü§ù Contributing

### How to Contribute

We welcome contributions! Here's how to get started:

#### 1. **Find an Issue or Propose a Feature**

- Check [GitHub Issues](https://github.com/stevenselcuk/thehangar/issues)
- Look for `good first issue` or `help wanted` labels
- Or propose a new feature via Discussions

#### 2. **Fork & Clone**

```bash
git clone https://github.com/YOUR_USERNAME/thehangar.git
cd thehangar
npm install
```

#### 3. **Create a Branch**

```bash
git checkout -b feature/my-new-action
# or
git checkout -b fix/sanity-drain-bug
```

#### 4. **Make Changes**

- Follow code style guidelines (see above)
- Write tests for new code (100% coverage required)
- Update documentation if needed

#### 5. **Run Quality Checks**

```bash
npm run lint:fix        # Fix linting issues
npm run format          # Format code
npm run typecheck       # Check TypeScript
npm test                # Run unit tests
npm run test:e2e        # Run E2E tests
```

#### 6. **Commit & Push**

```bash
git add .
git commit -m "feat: add INSPECT_WING action"
git push origin feature/my-new-action
```

#### 7. **Create Pull Request**

- Go to GitHub and create PR from your branch
- Fill out PR template
- Wait for CI/CD checks to pass
- Respond to review feedback

### Pull Request Checklist

Before submitting, ensure:

- [ ] TypeScript compiles without errors (`npm run typecheck`)
- [ ] ESLint passes with zero warnings (`npm run lint`)
- [ ] All tests pass (`npm test` and `npm run test:e2e`)
- [ ] Code coverage doesn't decrease (`npm run test:coverage`)
- [ ] New features have 100% test coverage
- [ ] Documentation updated (README, copilot-instructions)
- [ ] Manual testing in dev environment
- [ ] Horror/Lovecraftian theme maintained (for narrative content)
- [ ] Commit messages follow [Conventional Commits](https://www.conventionalcommits.org/)
- [ ] PR description explains "why" not just "what"

### Commit Message Format

Follow [Conventional Commits](https://www.conventionalcommits.org/):

```
feat: add new INSPECT_WING action to hangar
fix: correct sanity drain calculation in Backshops
docs: update README with new gameplay section
test: add coverage for inventorySlice edge cases
chore: upgrade Vite to 6.2.1
refactor: extract log formatting into service
perf: memoize expensive XP calculations
```

**Types**:

- `feat`: New feature
- `fix`: Bug fix
- `docs`: Documentation changes
- `test`: Test additions/fixes
- `chore`: Maintenance (deps, config)
- `refactor`: Code restructuring (no behavior change)
- `perf`: Performance improvements

### Lovecraftian Writing Guidelines

When adding narrative content (events, logs, descriptions):

‚úÖ **DO**:

- Use precise aviation terminology
- Maintain clinical, detached tone
- Ground horror in technical failures
- Leave room for ambiguity
- Escalate weirdness gradually
- Example: _"The rivet exhibits thermal expansion outside rated parameters. The metal is warm to the touch. It should not be warm."_

‚ùå **DON'T**:

- Explicit supernatural explanations ("a demon appears")
- Over-the-top gore or shock value
- Breaking character (technician wouldn't say "eldritch")
- Anachronistic language
- Example: _"OMG a spooky ghost haunts the hangar!!!"_ (Too casual, too explicit)

For full guidelines, see `.github/copilot-instructions.md`, section "Lovecraftian Horror Writing Style".

---

## üìã Roadmap

### Version 1.0 (Target: Q2 2026)

**Must-Have**:

- [ ] Component test coverage > 90%
- [ ] All 50 levels fully balanced
- [ ] Audio engine (ambient sounds, event stingers)
- [ ] Achievement system (25+ achievements)
- [ ] Tutorial/onboarding flow for new players
- [ ] Accessibility improvements (screen reader support)
- [ ] Localization framework (English first, more languages later)

### Version 1.1 (Target: Q3 2026)

**Expansion Content**:

- [ ] New aircraft types: A380, B787, regional jets (CRJ, ERJ)
- [ ] Deeper skill trees: Avionics specialization, management track
- [ ] New location: Cargo Warehouse (freighter operations)
- [ ] New events: Union strike, NTSB investigation, quarantine
- [ ] New endings: 2 additional endings (5 total)

### Version 2.0 (Target: Q4 2026)

**Major Features**:

- [ ] New Game+ mode (carry over knowledge, increased difficulty)
- [ ] Multiplayer leaderboards (survived shifts, sanity retention)
- [ ] Daily challenges (procedurally generated scenarios)
- [ ] Mod support (custom events, aircraft, endings)
- [ ] Mobile app (Capacitor-based native wrapper)

### Long-Term Vision

- [ ] Co-op mode (2-4 players, shared facility)
- [ ] Narrative DLC: "The Heathrow Incident", "SLS-3 Debrief"
- [ ] VR support (experimental, desktop VR only)
- [ ] Official merchandise (F.O.D. plushie, Suits poster)

### Performance Optimization (Ongoing)

- [ ] Bundle size reduction (target: < 100KB gzipped)
- [ ] Code splitting per tab (lazy load on navigation)
- [ ] Web Worker for tick processor (offload from main thread)
- [ ] IndexedDB migration (move saves off localStorage)
- [ ] Service Worker (offline play support)

---

## üêõ Known Issues

### High Priority

**1. Component Test Coverage** ‚ö†Ô∏è

- **Issue**: Only ~5% of React components have tests
- **Impact**: Regression risk during refactoring
- **Workaround**: Manual testing before major releases
- **Fix**: Planned for v1.0 milestone

**2. Safari Audio Bug**

- **Issue**: Audio playback sometimes fails on first interaction (iOS Safari)
- **Impact**: No sound effects until second click
- **Workaround**: Tap screen twice on first load
- **Fix**: Investigating Web Audio API workaround

### Medium Priority

**3. localStorage Quota**

- **Issue**: Long-running saves approach 5MB quota on some browsers
- **Impact**: Auto-save may fail silently after 100+ hours
- **Workaround**: Manual save/export, start new game
- **Fix**: Migration to IndexedDB planned

**4. E2E Test Flakiness**

- **Issue**: Playwright tests occasionally timeout on CI
- **Impact**: False negative build failures (~2% of runs)
- **Workaround**: Re-run workflow
- **Fix**: Investigating increased timeouts and retry logic

### Low Priority

**5. Mobile Landscape Layout**

- **Issue**: Some UI elements clip on narrow landscape screens (< 667px wide)
- **Impact**: Minor UX issue, not blocking
- **Workaround**: Use portrait mode
- **Fix**: Responsive design improvements planned

**6. Performance on Old Devices**

- **Issue**: Tick rate drops below 15 FPS on devices > 5 years old
- **Impact**: Slower passive resource regeneration
- **Workaround**: None (hardware limitation)
- **Fix**: Investigating frame skipping logic

---

## üìÑ License

**MIT License**

Copyright (c) 2026 Steven J. Selcuk

Permission is hereby granted, free of charge, to any person obtaining a copy of this software and associated documentation files (the "Software"), to deal in the Software without restriction, including without limitation the rights to use, copy, modify, merge, publish, distribute, sublicense, and/or sell copies of the Software, and to permit persons to whom the Software is furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY, FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE SOFTWARE.

---

## üôè Credits & Acknowledgments

### Development

- **Game Design & Programming**: [Steven J. Selcuk](https://github.com/stevenselcuk)
- **Testing Framework**: Vitest, Playwright, React Testing Library
- **Built With**: React 19, TypeScript 5.8, Vite 6.2

### Inspiration

- **Game Design**: Universal Paperclips, A Dark Room, Candy Box
- **Horror Aesthetic**: SCP Foundation, Control (Remedy), The Magnus Archives
- **Aviation**: Real-world experience in commercial aviation maintenance

### Special Thanks

- Open source community for tools and libraries
- Playtesters for feedback and bug reports
- Aviation professionals who reviewed technical accuracy
- Lovecraft community for cosmic horror discourse

---

## üìû Support & Community

### Get Help

- **Bug Reports**: [GitHub Issues](https://github.com/stevenselcuk/thehangar/issues/new?template=bug_report.md)
- **Feature Requests**: [GitHub Discussions](https://github.com/stevenselcuk/thehangar/discussions/new?category=ideas)
- **Gameplay Questions**: [GitHub Discussions - Q&A](https://github.com/stevenselcuk/thehangar/discussions/new?category=q-a)

### Community Links

- **Discord**: [Coming Soon]
- **Reddit**: [r/TheHangarGame](https://reddit.com/r/TheHangarGame) [Coming Soon]
- **Twitter/X**: [@HangarGame](https://twitter.com/HangarGame) [Coming Soon]

### Contact

- **Email**: [steven@tabbythecat.com](mailto:steven@tabbythecat.com)
- **GitHub**: [@stevenselcuk](https://github.com/stevenselcuk)

---

## ‚ö†Ô∏è Content Warning

This game contains themes and content that may be disturbing to some players:

- **Workplace Anxiety**: Corporate bureaucracy, job insecurity, performance reviews
- **Cosmic Horror**: Existential dread, incomprehensible entities, reality distortion
- **Psychological Horror**: Sanity degradation, paranoia, gaslighting
- **Mild Body Horror**: References to biological anomalies (nothing graphic)
- **Mild Violence**: Implied workplace accidents (no gore or explicit descriptions)

**Recommended Age**: 16+

**Not Recommended For**:

- Individuals with severe workplace-related PTSD
- Those sensitive to themes of loss of agency or sanity
- Players seeking relaxing/casual idle games

**It IS Recommended For**:

- Fans of Lovecraftian horror and cosmic dread
- Aviation professionals with dark humor
- Incremental game enthusiasts seeking depth
- Narrative-driven game fans

---

## üåü Final Notes

**The Hangar** is a passion project exploring the intersection of aviation, horror, and incremental game design. It's completely free, has no ads, collects no data, and respects your time.

If you enjoy the game:

- ‚≠ê **Star the repo** on GitHub
- üêõ **Report bugs** you encounter
- üí° **Suggest features** you'd like to see
- üé® **Contribute code** if you're a developer
- üì¢ **Share with friends** who enjoy horror or idle games

Remember: _The rivets hold. The paperwork is filed. The night shift begins._

**And somewhere in the metal darkness, something waits.**

---

_"Do not look directly at The Suits. Do not ask what happened to the previous technician. Do not open the door marked SLS-3. The cat knows more than it says. The sedan arrives at 02:17. Always."_

_‚ÄîThe Regular_

---

**Play Now**: [hangar.tabbythecat.com](https://hangar.tabbythecat.com) | [GitHub](https://github.com/stevenselcuk/thehangar) | [Report Bug](https://github.com/stevenselcuk/thehangar/issues/new)

_Last Updated: February 6, 2026_
